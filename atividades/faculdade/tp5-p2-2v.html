<!DOCTYPE html>
<html lang="pt-BR">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>TP5 P2 - Cadastro de Alunos e Notas (Complemento)</title>
ย ย <style>
ย ย ย ย body {
ย ย ย ย ย ย font-family: Arial, sans-serif;
ย ย ย ย ย ย background-color: #f4f4f9;
ย ย ย ย ย ย color: #333;
ย ย ย ย ย ย padding: 20px;
ย ย ย ย ย ย margin: 0;
ย ย ย ย }
ย ย ย ย .container {
ย ย ย ย ย ย max-width: 900px;
ย ย ย ย ย ย margin: 0 auto;
ย ย ย ย ย ย background: #fff;
ย ย ย ย ย ย padding: 30px;
ย ย ย ย ย ย border-radius: 8px;
ย ย ย ย ย ย box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
ย ย ย ย }
ย ย ย ย h1, h2 {
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย color: #0056b3;
ย ย ย ย }
ย ย ย ย /* --- Estilizaรงรฃo do Formulรกrio --- */
ย ย ย ย #formCadastro {
ย ย ย ย ย ย display: grid;
ย ย ย ย ย ย grid-template-columns: 1fr 1fr 1fr auto;
ย ย ย ย ย ย gap: 20px;
ย ย ย ย ย ย margin-bottom: 30px;
ย ย ย ย ย ย padding: 20px;
ย ย ย ย ย ย border: 1px solid #ddd;
ย ย ย ย ย ย border-radius: 4px;
ย ย ย ย }
ย ย ย ย .form-group {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย flex-direction: column;
ย ย ย ย }
ย ย ย ย label {
ย ย ย ย ย ย margin-bottom: 5px;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย }
ย ย ย ย input[type="text"], input[type="number"], select {
ย ย ย ย ย ย padding: 8px;
ย ย ย ย ย ย border: 1px solid #ccc;
ย ย ย ย ย ย border-radius: 4px;
ย ย ย ย ย ย font-size: 1em;
ย ย ย ย }
ย ย ย ย /* Estilos genรฉricos para botรตes */
ย ย ย ย button {
ย ย ย ย ย ย padding: 10px 15px;
ย ย ย ย ย ย background-color: #007bff;
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย border-radius: 4px;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย font-size: 1em;
ย ย ย ย ย ย transition: background-color 0.3s;
ย ย ย ย }
ย ย ย ย button:hover {
ย ย ย ย ย ย background-color: #0056b3;
ย ย ย ย }

ย ย ย ย /* Botรฃo Salvar Aluno */
ย ย ย ย #btnSalvar {
ย ย ย ย ย ย align-self: flex-end; /* Alinha o botรฃo com os campos */
ย ย ย ย }
ย ย ย ย /* Botรฃo Limpar Dados */
ย ย ย ย #btnLimpar {
ย ย ย ย ย ย background-color: #dc3545;
ย ย ย ย ย ย margin-top: 20px;
ย ย ย ย ย ย display: block;
ย ย ย ย }
ย ย ย ย #btnLimpar:hover {
ย ย ย ย ย ย background-color: #c82333;
ย ย ย ย }

ย ย ย ย /* Estilos especรญficos para a Tabela */
ย ย ย ย #tabelaAlunos {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย border-collapse: collapse;
ย ย ย ย ย ย margin-top: 20px;
ย ย ย ย }
ย ย ย ย #tabelaAlunos th, #tabelaAlunos td {
ย ย ย ย ย ย padding: 12px;
ย ย ย ย ย ย border: 1px solid #ddd;
ย ย ย ย ย ย text-align: left;
ย ย ย ย }
ย ย ย ย #tabelaAlunos thead {
ย ย ย ย ย ย background-color: #f8f8f8;
ย ย ย ย }
ย ย ย ย #tabelaAlunos th.sortable {
ย ย ย ย ย ย position: relative;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย }
ย ย ย ย .sort-icon {
ย ย ย ย ย ย margin-left: 5px;
ย ย ย ย ย ย font-style: normal;
ย ย ย ย ย ย font-weight: normal;
ย ย ย ย ย ย float: right;
ย ย ย ย }
ย ย ย ย /* Indicadores de Classificaรงรฃo */
ย ย ย ย th[aria-sort="ascending"] .sort-icon::after { content: " โฒ"; }
ย ย ย ย th[aria-sort="descending"] .sort-icon::after { content: " โผ"; }
ย ย ย ย th:not([aria-sort]) .sort-icon::after { content: " โ"; }

ย ย ย ย /* Cores das Notas */
ย ย ย ย .nota-inferior {
ย ย ย ย ย ย background-color: #ffcccc; /* Vermelho bem claro */
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย }
ย ย ย ย .nota-superior {
ย ย ย ย ย ย background-color: #cceeff; /* Azul bem claro */
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย }
ย ย ย ย /* Estilo para o filtro */
ย ย ย ย #filtroContainer {
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย ย ย padding: 15px;
ย ย ย ย ย ย border: 1px solid #ccc;
ย ย ย ย ย ย border-radius: 4px;
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย gap: 10px;
ย ย ย ย }
ย ย ย ย /* Estilo para a mensagem de erro */
ย ย ย ย .error-message {
ย ย ย ย ย ย color: #dc3545;
ย ย ย ย ย ย font-size: 0.85em;
ย ย ย ย ย ย margin-top: 5px;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย display: none;
ย ย ย ย }
ย ย ย ย input.input-error {
ย ย ย ย ย ย border: 2px solid #dc3545;
ย ย ย ย }

ย ย ย ย /* Estilos para os novos botรตes de aรงรฃo na tabela */
ย ย ย ย .btn-tabela {
ย ย ย ย ย ย padding: 5px 10px;
ย ย ย ย ย ย font-size: 0.85em;
ย ย ย ย ย ย margin: 2px;
ย ย ย ย }
ย ย ย ย .btn-alterar {
ย ย ย ย ย ย background-color: #ffc107; /* Amarelo */
ย ย ย ย ย ย color: #333;
ย ย ย ย }
ย ย ย ย .btn-alterar:hover {
ย ย ย ย ย ย background-color: #e0a800;
ย ย ย ย }
ย ย ย ย .btn-excluir {
ย ย ย ย ย ย background-color: #dc3545; /* Vermelho */
ย ย ย ย }
ย ย ย ย .btn-excluir:hover {
ย ย ย ย ย ย background-color: #c82333;
ย ย ย ย }
ย ย </style>
</head>
<body>
ย ย <h1>Cadastro e Classificaรงรฃo de Alunos</h1>
ย ย <div class="container">
ย ย ย ย <form id="formCadastro">
ย ย ย ย ย ย <h2>Inserir Novo Aluno</h2>
ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย <label for="nome">Nome:</label>
ย ย ย ย ย ย ย ย <input type="text" id="nome" required>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย <label for="endereco">Endereรงo:</label>
ย ย ย ย ย ย ย ย <input type="text" id="endereco" required>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย <label for="nota">Nota (0 a 10):</label>
ย ย ย ย ย ย ย ย <input type="number" id="nota" min="0" max="10" step="0.1" required>
ย ย ย ย ย ย ย ย <span id="notaError" class="error-message"></span>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <button type="submit" id="btnSalvar">Salvar Aluno</button>
ย ย ย ย </form>
ย ย ย ย <hr>
ย ย ย ย <h2>Tabela de Alunos</h2>
ย ย ย ย <div id="filtroContainer">
ย ย ย ย ย ย <label for="filtroNota">Filtrar Notas:</label>
ย ย ย ย ย ย <select id="filtroNota">
ย ย ย ย ย ย ย ย <option value="todos">Todos os Alunos</option>
ย ย ย ย ย ย ย ย <option value="maior9">Notas Superiores a 9 (>9)</option>
ย ย ย ย ย ย ย ย <option value="menor5">Notas Menores que 5 (<5)</option>
ย ย ย ย ย ย ย ย <option value="entre5e9">Notas Entre 5 e 9 (5.0 a 9.0)</option>
ย ย ย ย ย ย </select>
ย ย ย ย </div>
ย ย ย ย <table id="tabelaAlunos">
ย ย ย ย ย ย <thead>
ย ย ย ย ย ย ย ย <tr>
ย ย ย ย ย ย ย ย ย ย <th data-sort-key="nome" class="sortable">Nome <span class="sort-icon"></span></th>
ย ย ย ย ย ย ย ย ย ย <th>Endereรงo</th>
ย ย ย ย ย ย ย ย ย ย <th data-sort-key="nota" class="sortable">Nota <span class="sort-icon"></span></th>
ย ย ย ย ย ย ย ย ย ย <th>Aรงรตes</th> ย ย ย ย ย ย ย ย </tr>
ย ย ย ย ย ย </thead>
ย ย ย ย ย ย <tbody>
ย ย ย ย ย ย </tbody>
ย ย ย ย </table>
ย ย ย ย <button id="btnLimpar">Limpar Todos os Dados</button>
ย ย </div>
ย ย <script>
ย ย ย ย document.addEventListener('DOMContentLoaded', () => {
ย ย ย ย ย ย const formCadastro = document.getElementById('formCadastro');
ย ย ย ย ย ย const tabelaBody = document.querySelector('#tabelaAlunos tbody');
ย ย ย ย ย ย const tabelaHeaders = document.querySelectorAll('#tabelaAlunos th.sortable');
ย ย ย ย ย ย const btnLimpar = document.getElementById('btnLimpar');
ย ย ย ย ย ย const filtroNotaSelect = document.getElementById('filtroNota');

ย ย ย ย ย ย const inputNota = document.getElementById('nota');
ย ย ย ย ย ย const notaError = document.getElementById('notaError');ย

ย ย ย ย ย ย let alunos = [];
ย ย ย ย ย ย let classificacaoAtiva = { chave: 'nome', direcao: 'asc' };

ย ย ย ย ย ย // --- Funรงรตes Auxiliares ---

ย ย ย ย ย ย const limparErroNota = () => {
ย ย ย ย ย ย ย ย notaError.textContent = '';
ย ย ย ย ย ย ย ย notaError.style.display = 'none';
ย ย ย ย ย ย ย ย inputNota.classList.remove('input-error');
ย ย ย ย ย ย };

ย ย ย ย ย ย const mostrarErroNota = (mensagem) => {
ย ย ย ย ย ย ย ย notaError.textContent = mensagem;
ย ย ย ย ย ย ย ย notaError.style.display = 'block';
ย ย ย ย ย ย ย ย inputNota.classList.add('input-error');
ย ย ย ย ย ย };

ย ย ย ย ย ย const carregarAlunos = () => {
ย ย ย ย ย ย ย ย const dadosJSON = localStorage.getItem('alunosData');
ย ย ย ย ย ย ย ย if (dadosJSON) {
ย ย ย ย ย ย ย ย ย ย // Usa map para garantir que a nota seja tratada como float
ย ย ย ย ย ย ย ย ย ย alunos = JSON.parse(dadosJSON).map(aluno => ({
ย ย ย ย ย ย ย ย ย ย ย ย ...aluno,
ย ย ย ย ย ย ย ย ย ย ย ย nota: parseFloat(aluno.nota) // Garante que a nota รฉ um nรบmero
ย ย ย ย ย ย ย ย ย ย }));
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย alunos = [];
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย classificarAlunos('nome', 'asc', false);ย
ย ย ย ย ย ย ย ย document.querySelector('th[data-sort-key="nome"]').setAttribute('aria-sort', 'ascending');
ย ย ย ย ย ย };

ย ย ย ย ย ย const salvarAlunos = () => {
ย ย ย ย ย ย ย ย localStorage.setItem('alunosData', JSON.stringify(alunos));
ย ย ย ย ย ย };

ย ย ย ย ย ย const getClassificacaoCor = (nota) => {
ย ย ย ย ย ย ย ย if (nota < 5) {
ย ย ย ย ย ย ย ย ย ย return 'nota-inferior';
ย ย ย ย ย ย ย ย } else if (nota > 9) {
ย ย ย ย ย ย ย ย ย ย return 'nota-superior';
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย return '';
ย ย ย ย ย ย };

ย ย ย ย ย ย const filtrarAlunos = (listaAlunos, filtro) => {
ย ย ย ย ย ย ย ย switch (filtro) {
ย ย ย ย ย ย ย ย ย ย case 'menor5':
ย ย ย ย ย ย ย ย ย ย ย ย return listaAlunos.filter(aluno => aluno.nota < 5);
ย ย ย ย ย ย ย ย ย ย case 'maior9':
ย ย ย ย ย ย ย ย ย ย ย ย return listaAlunos.filter(aluno => aluno.nota > 9);
ย ย ย ย ย ย ย ย ย ย case 'entre5e9':
ย ย ย ย ย ย ย ย ย ย ย ย return listaAlunos.filter(aluno => aluno.nota >= 5 && aluno.nota <= 9);
ย ย ย ย ย ย ย ย ย ย case 'todos':
ย ย ย ย ย ย ย ย ย ย default:
ย ย ย ย ย ย ย ย ย ย ย ย return listaAlunos;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย };

ย ย ย ย ย ย // Funรงรตes para os Novos Requisitos
ย ย ย ย ย ย 
ย ย ย ย ย ย // ** REQUISITO 2: Excluir Aluno **
ย ย ย ย ย ย window.excluirAluno = (index) => {
ย ย ย ย ย ย ย ย if (confirm(`Tem certeza que deseja EXCLUIR o aluno(a) ${alunos[index].nome}?`)) {
ย ย ย ย ย ย ย ย ย ย alunos.splice(index, 1); // Remove o aluno do array
ย ย ย ย ย ย ย ย ย ย salvarAlunos(); // Salva a alteraรงรฃo
ย ย ย ย ย ย ย ย ย ย exibirAlunosNaTabela(alunos); // Reexibe a tabela
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย };

ย ย ย ย ย ย // ** REQUISITO 1: Alterar Nota do Aluno **
ย ย ย ย ย ย window.alterarNota = (index) => {
ย ย ย ย ย ย ย ย const aluno = alunos[index];
ย ย ย ย ย ย ย ย const novaNotaStr = prompt(`Digite a nova nota (0 a 10) para ${aluno.nome}:`, aluno.nota.toFixed(1));

ย ย ย ย ย ย ย ย // Se o usuรกrio cancelar ou nรฃo digitar nada
ย ย ย ย ย ย ย ย if (novaNotaStr === null || novaNotaStr.trim() === "") {
ย ย ย ย ย ย ย ย ย ย return; // Cancela a operaรงรฃo
ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย const novaNota = parseFloat(novaNotaStr);

ย ย ย ย ย ย ย ย // Validaรงรฃo da nota
ย ย ย ย ย ย ย ย if (isNaN(novaNota) || novaNota < 0 || novaNota > 10) {
ย ย ย ย ย ย ย ย ย ย alert(`A nota inserida (${novaNotaStr}) รฉ invรกlida. Digite um valor entre 0 e 10.`);
ย ย ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // Atualiza a nota do aluno no array
ย ย ย ย ย ย ย ย alunos[index].nota = novaNota;
ย ย ย ย ย ย ย ย salvarAlunos(); // Salva a alteraรงรฃo
ย ย ย ย ย ย ย ย // Reexibe a lista para aplicar a cor e a ordenaรงรฃo correta
ย ย ย ย ย ย ย ย classificarAlunos(classificacaoAtiva.chave, classificacaoAtiva.direcao);
ย ย ย ย ย ย ย ย alert(`Nota de ${aluno.nome} alterada para ${novaNota.toFixed(1)} com sucesso!`);
ย ย ย ย ย ย };

ย ย ย ย ย ย // Funรงรฃo que exibe os alunos (adiciona botรตes de aรงรฃo)
ย ย ย ย ย ย const exibirAlunosNaTabela = (listaAlunos) => {
ย ย ย ย ย ย ย ย const filtroAtual = filtroNotaSelect.value;
ย ย ย ย ย ย ย ย const alunosFiltrados = filtrarAlunos(listaAlunos, filtroAtual);

ย ย ย ย ย ย ย ย tabelaBody.innerHTML = '';
ย ย ย ย ย ย ย ย // Usa o รญndice do aluno no array ORIGINAL para as aรงรตes de Excluir/Alterar
ย ย ย ย ย ย ย ย alunosFiltrados.forEach((alunoFiltrado) => {
ย ย ย ย ย ย ย ย ย ย // Encontra o รญndice original do aluno filtrado no array 'alunos'
ย ย ย ย ย ย ย ย ย ย const indexOriginal = alunos.findIndex(aluno => 
ย ย ย ย ย ย ย ย ย ย ย ย aluno.nome === alunoFiltrado.nome && 
ย ย ย ย ย ย ย ย ย ย ย ย aluno.endereco === alunoFiltrado.endereco && 
ย ย ย ย ย ย ย ย ย ย ย ย aluno.nota === alunoFiltrado.nota
ย ย ย ย ย ย ย ย ย ย );

ย ย ย ย ย ย ย ย ย ย const row = tabelaBody.insertRow();
ย ย ย ย ย ย ย ย ย ย row.insertCell().textContent = alunoFiltrado.nome;
ย ย ย ย ย ย ย ย ย ย row.insertCell().textContent = alunoFiltrado.endereco;
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย let cellNota = row.insertCell();
ย ย ย ย ย ย ย ย ย ย cellNota.textContent = alunoFiltrado.nota.toFixed(1);
ย ย ย ย ย ย ย ย ย ย cellNota.classList.add(getClassificacaoCor(alunoFiltrado.nota));
ย ย ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย ย ย // Cรฉlula de Aรงรตes
ย ย ย ย ย ย ย ย ย ย let cellAcoes = row.insertCell();
ย ย ย ย ย ย ย ย ย ย cellAcoes.innerHTML = `
ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-tabela btn-alterar" onclick="alterarNota(${indexOriginal})">โ๏ธ Alterar Nota</button>
ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-tabela btn-excluir" onclick="excluirAluno(${indexOriginal})">๐๏ธ Excluir</button>
ย ย ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย };

ย ย ย ย ย ย // Funรงรฃo para classificar e salvar o estado de classificaรงรฃo
ย ย ย ย ย ย const classificarAlunos = (chave, direcao, updateActiveState = true) => {
ย ย ย ย ย ย ย ย alunos.sort((a, b) => {
ย ย ย ย ย ย ย ย ย ย let valorA = a[chave];
ย ย ย ย ย ย ย ย ย ย let valorB = b[chave];

ย ย ย ย ย ย ย ย ย ย if (chave === 'nota') {
ย ย ย ย ย ย ย ย ย ย ย ย valorA = parseFloat(valorA);
ย ย ย ย ย ย ย ย ย ย ย ย valorB = parseFloat(valorB);
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย valorA = String(valorA).toLowerCase();
ย ย ย ย ย ย ย ย ย ย ย ย valorB = String(valorB).toLowerCase();
ย ย ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย ย ย if (valorA < valorB) {
ย ย ย ย ย ย ย ย ย ย ย ย return direcao === 'asc' ? -1 : 1;
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย if (valorA > valorB) {
ย ย ย ย ย ย ย ย ย ย ย ย return direcao === 'asc' ? 1 : -1;
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย return 0;
ย ย ย ย ย ย ย ย });

ย ย ย ย ย ย ย ย if (updateActiveState) {
ย ย ย ย ย ย ย ย ย ย classificacaoAtiva = { chave, direcao };
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย exibirAlunosNaTabela(alunos);
ย ย ย ย ย ย };

ย ย ย ย ย ย // --- Event Listeners ---

ย ย ย ย ย ย formCadastro.addEventListener('submit', (e) => {
ย ย ย ย ย ย ย ย e.preventDefault();
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย limparErroNota();ย

ย ย ย ย ย ย ย ย const nome = document.getElementById('nome').value.trim();
ย ย ย ย ย ย ย ย const endereco = document.getElementById('endereco').value.trim();
ย ย ย ย ย ย ย ย const nota = parseFloat(inputNota.value);

ย ย ย ย ย ย ย ย if (isNaN(nota) || nota < 0 || nota > 10) {
ย ย ย ย ย ย ย ย ย ย const mensagem = `Erro: A nota deve ser entre 0.0 e 10.0. Vocรช inseriu ${inputNota.value}.`;
ย ย ย ย ย ย ย ย ย ย mostrarErroNota(mensagem);
ย ย ย ย ย ย ย ย ย ย return;ย
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย if (!nome || !endereco) {
ย ย ย ย ย ย ย ย ย ย alert('Por favor, preencha todos os campos (Nome e Endereรงo).');
ย ย ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย const novoAluno = {
ย ย ย ย ย ย ย ย ย ย nome: nome,
ย ย ย ย ย ย ย ย ย ย endereco: endereco,
ย ย ย ย ย ย ย ย ย ย nota: nota
ย ย ย ย ย ย ย ย };
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย alunos.push(novoAluno);
ย ย ย ย ย ย ย ย salvarAlunos();ย

ย ย ย ย ย ย ย ย classificarAlunos(classificacaoAtiva.chave, classificacaoAtiva.direcao);

ย ย ย ย ย ย ย ย formCadastro.reset();
ย ย ย ย ย ย ย ย document.getElementById('nome').focus();
ย ย ย ย ย ย });

ย ย ย ย ย ย // Lรณgica de Classificaรงรฃo da Tabela
ย ย ย ย ย ย tabelaHeaders.forEach(header => {
ย ย ย ย ย ย ย ย header.addEventListener('click', () => {
ย ย ย ย ย ย ย ย ย ย const chave = header.getAttribute('data-sort-key');
ย ย ย ย ย ย ย ย ย ย let direcaoAtual = header.getAttribute('aria-sort');
ย ย ย ย ย ย ย ย ย ย let novaDirecao = '';

ย ย ย ย ย ย ย ย ย ย if (chave === 'nota') {
ย ย ย ย ย ย ย ย ย ย ย ย if (direcaoAtual === 'descending') {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = 'ascending';
ย ย ย ย ย ย ย ย ย ย ย ย } else if (direcaoAtual === 'ascending') {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = null;
ย ย ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = 'descending';
ย ย ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย } else { // Para "nome"
ย ย ย ย ย ย ย ย ย ย ย ย if (direcaoAtual === 'ascending') {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = 'descending';
ย ย ย ย ย ย ย ย ย ย ย ย } else if (direcaoAtual === 'descending') {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = null;
ย ย ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย novaDirecao = 'ascending';
ย ย ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย ย ย tabelaHeaders.forEach(th => th.removeAttribute('aria-sort'));

ย ย ย ย ย ย ย ย ย ย if (novaDirecao) {
ย ย ย ย ย ย ย ย ย ย ย ย header.setAttribute('aria-sort', novaDirecao);
ย ย ย ย ย ย ย ย ย ย ย ย const direcaoParaFuncao = novaDirecao === 'ascending' ? 'asc' : 'desc';
ย ย ย ย ย ย ย ย ย ย ย ย classificarAlunos(chave, direcaoParaFuncao);
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย // Volta para a ordem inicial (Nome ASC)
ย ย ย ย ย ย ย ย ย ย ย ย document.querySelector('th[data-sort-key="nome"]').setAttribute('aria-sort', 'ascending');
ย ย ย ย ย ย ย ย ย ย ย ย classificarAlunos('nome', 'asc');
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย });

ย ย ย ย ย ย // Evento para o Filtro de Notas
ย ย ย ย ย ย filtroNotaSelect.addEventListener('change', () => {
ย ย ย ย ย ย ย ย exibirAlunosNaTabela(alunos);ย
ย ย ย ย ย ย });

ย ย ย ย ย ย // Botรฃo Limpar Dados
ย ย ย ย ย ย btnLimpar.addEventListener('click', () => {
ย ย ย ย ย ย ย ย if(confirm('Tem certeza que deseja limpar TODOS os dados de alunos? Esta aรงรฃo รฉ irreversรญvel!')) {
ย ย ย ย ย ย ย ย ย ย localStorage.removeItem('alunosData');
ย ย ย ย ย ย ย ย ย ย alunos = [];
ย ย ย ย ย ย ย ย ย ย // Reinicializa a visualizaรงรฃo para o estado padrรฃo
ย ย ย ย ย ย ย ย ย ย filtroNotaSelect.value = 'todos';ย
ย ย ย ย ย ย ย ย ย ย tabelaHeaders.forEach(th => th.removeAttribute('aria-sort'));
ย ย ย ย ย ย ย ย ย ย document.querySelector('th[data-sort-key="nome"]').setAttribute('aria-sort', 'ascending');
ย ย ย ย ย ย ย ย ย ย classificacaoAtiva = { chave: 'nome', direcao: 'asc' };
ย ย ย ย ย ย ย ย ย ย exibirAlunosNaTabela(alunos);

ย ย ย ย ย ย ย ย ย ย alert('Dados de alunos limpos com sucesso!');
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย });

ย ย ย ย ย ย // Inicializaรงรฃo: carrega, classifica por nome (asc) e exibe
ย ย ย ย ย ย carregarAlunos();
ย ย ย ย ย ย exibirAlunosNaTabela(alunos);
ย ย ย ย });
ย ย </script>
</body>
</html>
